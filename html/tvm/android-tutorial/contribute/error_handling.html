

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Error Handling Guide &mdash; tvm 0.6.dev documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/tvm_theme.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Submit a Pull Request" href="pull_request.html" />
    <link rel="prev" title="Code Guide and Tips" href="code_guide.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/tvm-logo-small.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.6.dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/index.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vta/index.html">VTA: Deep Learning Accelerator Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deploy/index.html">Deploy and Integration</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Contribute to TVM</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="community.html">TVM Community Guideline</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_review.html">Perform Code Reviews</a></li>
<li class="toctree-l2"><a class="reference internal" href="committer_guide.html">Committer Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="document.html">Write Document and Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="code_guide.html">Code Guide and Tips</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Error Handling Guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#raise-a-specific-error-in-c">Raise a Specific Error in C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-choose-an-error-type">How to choose an Error Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-wide-errors">System-wide Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frontend-errors">Frontend Errors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pull_request.html">Submit a Pull Request</a></li>
<li class="toctree-l2"><a class="reference internal" href="git_howto.html">Git Usage Tips</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../langref/index.html">Language Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api/python/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api_links.html">Links to API References</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/index.html">Design and Developer Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nnvm_top.html">NNVM Core Tensor Operators</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../genindex.html">Index</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tvm</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Contribute to TVM</a> &raquo;</li>
        
      <li>Error Handling Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/contribute/error_handling.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="error-handling-guide">
<span id="error-guide"></span><h1>Error Handling Guide<a class="headerlink" href="#error-handling-guide" title="Permalink to this headline">¶</a></h1>
<p>TVM contains structured error classes to indicate specific types of error.
Please raise a specific error type when possible, so that users can
write code to handle a specific error category if necessary.</p>
<p>All the error types are defined in <a class="reference internal" href="../api/python/error.html#module-tvm.error" title="tvm.error"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">tvm.error</span></code></a> namespace.
You can directly raise the specific error object in python.
In other languages like c++, you simply add <code class="docutils literal notranslate"><span class="pre">&lt;ErrorType&gt;:</span></code> prefix to
the error message(see below).</p>
<div class="section" id="raise-a-specific-error-in-c">
<h2>Raise a Specific Error in C++<a class="headerlink" href="#raise-a-specific-error-in-c" title="Permalink to this headline">¶</a></h2>
<p>You can add <code class="docutils literal notranslate"><span class="pre">&lt;ErrorType&gt;:</span></code> prefix to your error message to
raise an error of the corresponding type.
Note that you do not have to add a new type
<a class="reference internal" href="#tvm.error.TVMError" title="tvm.error.TVMError"><code class="xref any py py-class docutils literal notranslate"><span class="pre">tvm.error.TVMError</span></code></a> will be raised by default when
there is no error type prefix in the message.
This mechanism works for both <code class="docutils literal notranslate"><span class="pre">LOG(FATAL)</span></code> and <code class="docutils literal notranslate"><span class="pre">CHECK</span></code> macros.
The following code gives an example on how to do so.</p>
<div class="code c highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">src</span><span class="o">/</span><span class="n">api_test</span><span class="o">.</span><span class="n">cc</span>
<span class="n">void</span> <span class="n">ErrorTest</span><span class="p">(</span><span class="nb">int</span> <span class="n">x</span><span class="p">,</span> <span class="nb">int</span> <span class="n">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">CHECK_EQ</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;ValueError: expect x and y to be equal.&quot;</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">LOG</span><span class="p">(</span><span class="n">FATAL</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;InternalError: cannot reach here&quot;</span><span class="p">;</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The above function is registered as PackedFunc into the python frontend,
under the name <code class="docutils literal notranslate"><span class="pre">tvm._api_internal._ErrorTest</span></code>.
Here is what will happen if we call the registered function:</p>
<div class="code highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">tvm</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tvm</span><span class="o">.</span><span class="n">_api_internal</span><span class="o">.</span><span class="n">_ErrorTest</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;/path/to/tvm/python/tvm/_ffi/_ctypes/function.py&quot;</span>, line <span class="m">190</span>, in <span class="n">__call__</span>
    <span class="k">raise</span> <span class="n">get_last_ffi_error</span><span class="p">()</span>
<span class="gr">ValueError</span>: <span class="n">Traceback (most recent call last):</span>
<span class="go">  [bt] (3) /path/to/tvm/build/libtvm.so(TVMFuncCall+0x48) [0x7fab500b8ca8]</span>
<span class="go">  [bt] (2) /path/to/tvm/build/libtvm.so(+0x1c4126) [0x7fab4f7f5126]</span>
<span class="go">  [bt] (1) /path/to/tvm/build/libtvm.so(+0x1ba2f8) [0x7fab4f7eb2f8]</span>
<span class="go">  [bt] (0) /path/to/tvm/build/libtvm.so(+0x177d12) [0x7fab4f7a8d12]</span>
  File <span class="nb">&quot;/path/to/tvm/src/api/api_test.cc&quot;</span>, line <span class="m">80</span>
<span class="gr">ValueError</span>: <span class="n">Check failed: x == y (0 vs. 1) : expect x and y to be equal.</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tvm</span><span class="o">.</span><span class="n">_api_internal</span><span class="o">.</span><span class="n">_ErrorTest</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
  File <span class="nb">&quot;/path/to/tvm/python/tvm/_ffi/_ctypes/function.py&quot;</span>, line <span class="m">190</span>, in <span class="n">__call__</span>
    <span class="k">raise</span> <span class="n">get_last_ffi_error</span><span class="p">()</span>
<span class="gr">tvm.error.InternalError</span>: <span class="n">Traceback (most recent call last):</span>
<span class="go">  [bt] (3) /path/to/tvm/build/libtvm.so(TVMFuncCall+0x48) [0x7fab500b8ca8]</span>
<span class="go">  [bt] (2) /path/to/tvm/build/libtvm.so(+0x1c4126) [0x7fab4f7f5126]</span>
<span class="go">  [bt] (1) /path/to/tvm/build/libtvm.so(+0x1ba35c) [0x7fab4f7eb35c]</span>
<span class="go">  [bt] (0) /path/to/tvm/build/libtvm.so(+0x177d12) [0x7fab4f7a8d12]</span>
  File <span class="nb">&quot;/path/to/tvm/src/api/api_test.cc&quot;</span>, line <span class="m">83</span>
<span class="gr">InternalError</span>: <span class="n">cannot reach here</span>
<span class="go">TVM hint: You hit an internal error. Please open a thread on https://discuss.tvm.ai/ to report it.</span>
</pre></div>
</div>
<p>As you can see in the above example, TVM’s ffi system combines
both the python and c++’s stacktrace into a single message, and generate the
corresponding error class automatically.</p>
</div>
<div class="section" id="how-to-choose-an-error-type">
<h2>How to choose an Error Type<a class="headerlink" href="#how-to-choose-an-error-type" title="Permalink to this headline">¶</a></h2>
<p>You can go through the error types are listed below, try to use common
sense and also refer to the choices in the existing code.
We try to keep a reasonable amount of error types.
If you feel there is a need to add a new error type, do the following steps:</p>
<ul class="simple">
<li>Send a RFC proposal with a description and usage examples in the current codebase.</li>
<li>Add the new error type to <a class="reference internal" href="../api/python/error.html#module-tvm.error" title="tvm.error"><code class="xref any py py-mod docutils literal notranslate"><span class="pre">tvm.error</span></code></a> with clear documents.</li>
<li>Update the list in this file to include the new error type.</li>
<li>Change the code to use the new error type.</li>
</ul>
<p>We also recommend to use less abstraction when creating the short error messages.
The code is more readable in this way, and also opens path to craft specific
error messages when necessary.</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">preferred</span><span class="p">():</span>
    <span class="c1"># Very clear about what is being raised and what is the error message.</span>
    <span class="k">raise</span> <span class="n">OpNotImplemented</span><span class="p">(</span><span class="s2">&quot;Operator relu is not implemented in the MXNet fronend&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">_op_not_implemented</span><span class="p">(</span><span class="n">op_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">OpNotImplemented</span><span class="p">(</span><span class="s2">&quot;Operator </span><span class="si">{}</span><span class="s2"> is not implemented.&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">op_name</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">not_preferred</span><span class="p">():</span>
    <span class="c1"># Introduces another level of indirection.</span>
    <span class="k">raise</span> <span class="n">_op_not_implemented</span><span class="p">(</span><span class="s2">&quot;relu&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>If we need to introduce a wrapper function that constructs multi-line error messages,
please put wrapper in the same file so other developers can look up the implementation easily.</p>
</div>
<div class="section" id="system-wide-errors">
<h2>System-wide Errors<a class="headerlink" href="#system-wide-errors" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tvm.error.TVMError">
<em class="property">class </em><code class="descclassname">tvm.error.</code><code class="descname">TVMError</code><a class="headerlink" href="#tvm.error.TVMError" title="Permalink to this definition">¶</a></dt>
<dd><p>Default error thrown by TVM functions.</p>
<p>TVMError will be raised if you do not give any error type specification,</p>
</dd></dl>

<dl class="class">
<dt id="tvm.error.InternalError">
<em class="property">class </em><code class="descclassname">tvm.error.</code><code class="descname">InternalError</code><span class="sig-paren">(</span><em>msg</em><span class="sig-paren">)</span><a class="headerlink" href="#tvm.error.InternalError" title="Permalink to this definition">¶</a></dt>
<dd><p>Internal error in the system.</p>
<p class="rubric">Examples</p>
<div class="code c++ highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">//</span> <span class="n">Example</span> <span class="n">code</span> <span class="n">C</span><span class="o">++</span>
<span class="n">LOG</span><span class="p">(</span><span class="n">FATAL</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="s2">&quot;InternalError: internal error detail.&quot;</span><span class="p">;</span>
</pre></div>
</div>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Example code in python</span>
<span class="k">raise</span> <span class="n">InternalError</span><span class="p">(</span><span class="s2">&quot;internal error detail&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="frontend-errors">
<h2>Frontend Errors<a class="headerlink" href="#frontend-errors" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="tvm.error.OpNotImplemented">
<em class="property">class </em><code class="descclassname">tvm.error.</code><code class="descname">OpNotImplemented</code><a class="headerlink" href="#tvm.error.OpNotImplemented" title="Permalink to this definition">¶</a></dt>
<dd><p>Operator is not implemented.</p>
<p class="rubric">Example</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="n">OpNotImplemented</span><span class="p">(</span>
    <span class="s2">&quot;Operator </span><span class="si">{}</span><span class="s2"> is not supported in </span><span class="si">{}</span><span class="s2"> frontend&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">missing_op</span><span class="p">,</span> <span class="n">frontend_name</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tvm.error.OpAttributeInvalid">
<em class="property">class </em><code class="descclassname">tvm.error.</code><code class="descname">OpAttributeInvalid</code><a class="headerlink" href="#tvm.error.OpAttributeInvalid" title="Permalink to this definition">¶</a></dt>
<dd><p>Attribute value is invalid when taking in a frontend operator.</p>
<p class="rubric">Example</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="n">OpAttributeInvalid</span><span class="p">(</span>
    <span class="s2">&quot;Value </span><span class="si">{}</span><span class="s2"> in attribute </span><span class="si">{}</span><span class="s2"> of operator </span><span class="si">{}</span><span class="s2"> is not valid&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">value</span><span class="p">,</span> <span class="n">attr_name</span><span class="p">,</span> <span class="n">op_name</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="tvm.error.OpAttributeRequired">
<em class="property">class </em><code class="descclassname">tvm.error.</code><code class="descname">OpAttributeRequired</code><a class="headerlink" href="#tvm.error.OpAttributeRequired" title="Permalink to this definition">¶</a></dt>
<dd><p>Required attribute is not found.</p>
<p class="rubric">Example</p>
<div class="code python highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">raise</span> <span class="n">OpAttributeRequired</span><span class="p">(</span>
    <span class="s2">&quot;Required attribute </span><span class="si">{}</span><span class="s2"> not found in operator </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
        <span class="n">attr_name</span><span class="p">,</span> <span class="n">op_name</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="pull_request.html" class="btn btn-neutral float-right" title="Submit a Pull Request" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="code_guide.html" class="btn btn-neutral float-left" title="Code Guide and Tips" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, tvm developers

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-75982049-2', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>